{
  "version": 3,
  "sources": ["../../../app/routes/movies.$slug.watch.tsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/routes/movies.$slug.watch.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/routes/movies.$slug.watch.tsx\");\n  import.meta.hot.lastModified = \"1701808081017.0244\";\n}\n// REMIX HMR END\n\nimport { redirect } from '@remix-run/node';\nimport { Link, useLoaderData, useNavigate } from '@remix-run/react';\nimport { useEffect, useRef, useState } from 'react';\nimport { HiXCircle as CloseIcon, HiPlay as PlayIcon, HiPause as PauseIcon } from 'react-icons/hi2';\nexport async function loader({\n  params\n}) {\n  const {\n    slug\n  } = params;\n  if (!slug) {\n    throw redirect('/movies');\n  }\n  const movieResponse = await fetch(`https://api.example.com/movies/${slug}`).catch(error => {\n    throw redirect('/movies');\n  });\n  const movie = await movieResponse.json();\n  return {\n    movie\n  };\n}\nexport function meta({\n  data\n}) {\n  const {\n    movie\n  } = data || {};\n  if (movie == null) {\n    throw new Response('Missing movie', {\n      status: 400\n    });\n  }\n  return [{\n    title: `${movie.title} - Movie App`\n  }];\n}\nexport default function MoviePlayer() {\n  _s();\n  const {\n    movie\n  } = useLoaderData();\n  const videoRef = useRef(null);\n  const controls = useVideoControls(videoRef);\n  const navigate = useNavigate();\n  const mediaSourceUrl = useMediaSource(movie.slug);\n  useEffect(() => {\n    const goBackOnEscape = event => {\n      if (event.key === 'Escape') {\n        navigate(`/movies/${movie.slug}`);\n      }\n    };\n    document.addEventListener('keydown', goBackOnEscape);\n    return () => {\n      document.removeEventListener('keydown', goBackOnEscape);\n    };\n  });\n  return <div className=\"relative flex items-center bg-black h-full w-full\">\n      <section className=\"fixed top-0 left-0 right-0 p-10 flex bg-gradient-to-b from-black via-black to-transparent z-10\">\n        <div className=\"w-1/2\">\n          <h1 className=\"text-6xl font-extrabold mb-8\">{movie.title}</h1>\n          <p className=\"text-neutral-500 text-2xl\">{movie.description}</p>\n        </div>\n        <div className=\"w-1/2 flex justify-end\">\n          <Link to={`/movies/${movie.slug}`} className=\"text-5xl opacity-50 hover:opacity-100\">\n            <CloseIcon />\n          </Link>\n        </div>\n      </section>\n\n      <video ref={videoRef} autoPlay={true} preload=\"metadata\" className=\"w-full\" src={mediaSourceUrl} />\n\n      <section className=\"fixed left-0 bottom-0 right-0 p-10 flex items-center gap-10 bg-gradient-to-t from-black via-black to-transparent\">\n        <button className=\"button-primary\" onClick={controls.togglePlay}>\n          {controls.isPlaying ? <PauseIcon /> : <PlayIcon />}\n        </button>\n\n        <input id=\"timeline\" type=\"range\" step={0.1} min={0} max={100} value={controls.timeElapsed} className=\"w-full\" onChange={event => {\n        controls.updateTime(event.currentTarget.valueAsNumber);\n      }} onMouseDown={() => {\n        controls.pause();\n      }} onMouseUp={() => {\n        controls.play();\n      }} />\n        <label htmlFor=\"timeline\" hidden={true}>\n          Timeline\n        </label>\n\n        <input id=\"volume\" type=\"range\" step={0.1} min={0} max={1} value={controls.volume} onChange={event => {\n        controls.updateVolume(event.currentTarget.valueAsNumber);\n      }} />\n        <label htmlFor=\"volume\" hidden={true}>\n          Volume\n        </label>\n      </section>\n    </div>;\n}\n_s(MoviePlayer, \"z9+i6eF59j7HJUrR+t+iCJcAkmk=\", false, function () {\n  return [useLoaderData, useVideoControls, useNavigate, useMediaSource];\n});\n_c = MoviePlayer;\nfunction useMediaSource(slug) {\n  _s2();\n  const [url, setUrl] = useState('');\n  useEffect(() => {\n    if (typeof MediaSource === 'undefined') {\n      return;\n    }\n    const mediaSource = new MediaSource();\n    const mediaSourceUrl = URL.createObjectURL(mediaSource);\n    setUrl(mediaSourceUrl);\n    const fetchRemoteStream = async () => {\n      const buffer = mediaSource.addSourceBuffer('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"');\n      const response = await fetch(`https://api.example.com/movies/${slug}/stream`);\n      if (!response.body) {\n        return;\n      }\n      if (!response.ok) {\n        mediaSource.endOfStream('network');\n        return;\n      }\n      const reader = response.body.getReader();\n      async function readChunk() {\n        const {\n          value,\n          done\n        } = await reader.read();\n        if (done) {\n          return;\n        }\n        await new Promise((resolve, reject) => {\n          buffer.addEventListener('updateend', resolve, {\n            once: true\n          });\n          buffer.addEventListener('error', reject, {\n            once: true\n          });\n          buffer.appendBuffer(value);\n        });\n        return readChunk();\n      }\n      await readChunk();\n    };\n    mediaSource.addEventListener('sourceopen', fetchRemoteStream);\n    return () => {\n      mediaSource.removeEventListener('sourceopen', fetchRemoteStream);\n      if (mediaSource.readyState === 'open') {\n        mediaSource.endOfStream();\n      }\n    };\n  }, [slug]);\n  return url;\n}\n_s2(useMediaSource, \"h+YUGVX5DsH7gM5V1u06RlVk/XQ=\");\nfunction useVideoControls(videoRef) {\n  _s3();\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [timeElapsed, setTimeElapsed] = useState(0);\n  const [volume, setVolume] = useState(1);\n  useEffect(() => {\n    const {\n      current: player\n    } = videoRef;\n    if (!player) {\n      return;\n    }\n    player.addEventListener('play', () => setIsPlaying(true));\n    player.addEventListener('pause', () => setIsPlaying(false));\n    player.addEventListener('timeupdate', () => {\n      const timeElapsedPercent = Math.floor((100 / player.duration || 0) * player.currentTime);\n      setTimeElapsed(timeElapsedPercent);\n    });\n    player.addEventListener('volumechange', () => {\n      setVolume(player.volume);\n    });\n  }, [videoRef]);\n  const play = () => {\n    videoRef.current?.play();\n  };\n  const pause = () => {\n    videoRef.current?.pause();\n  };\n  const togglePlay = () => {\n    if (isPlaying) {\n      pause();\n    } else {\n      play();\n    }\n  };\n  const updateTime = timeElapsedPercent => {\n    const player = videoRef.current;\n    if (!player) {\n      return;\n    }\n    const nextTime = player.duration / 100 * timeElapsedPercent;\n    player.currentTime = nextTime;\n  };\n  const updateVolume = nextVolume => {\n    const player = videoRef.current;\n    if (!player) {\n      return;\n    }\n    player.volume = nextVolume;\n  };\n  return {\n    isPlaying,\n    timeElapsed,\n    volume,\n    play,\n    pause,\n    togglePlay,\n    updateTime,\n    updateVolume\n  };\n}\n_s3(useVideoControls, \"4o0lh4sJe/tBmPZWAWZjQWgh0K8=\");\nvar _c;\n$RefreshReg$(_c, \"MoviePlayer\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": ["import_react"]
}
